  <!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EcoTech: Localizador para Descarte Sustentável</title>
  <link rel="stylesheet" type="text/css" href="estilo.css"/>
  <style>
        * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: #e8f5e9;
    }

    header {
      background-color: #388e3c;
      color: white;
      padding: 20px;
      text-align: center;
    }

    nav {
      display: flex;
      justify-content: center;
      background-color: #66bb6a;
      flex-wrap: wrap;
    }

    nav button {
      background-color: #66bb6a;
      color: white;
      border: none;
      padding: 14px 20px;
      font-size: 16px;
      cursor: pointer;
    }

    nav button:hover,
    nav button.active {
      background-color: #388e3c;
    }

    section {
      display: none;
      padding: 20px;
      max-width: 1000px;
      margin: 0 auto;
    }

    section.active {
      display: block;
    }

    h3 {
      margin-top: 20px;
      font-size: 25px;
    }

    h2 {
      margin-top: 20px;
    }

    ul {
      margin-left: 20px;
      font-size: 20px;
    }

    .form-group {
      margin-top: 20px;
    }

    label,
    input,
    button {
      display: block;
      margin-top: 5px;
      width: 100%;
      padding: 10px;
    }

    button {
      background-color: #388e3c;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 10px;
      width: 200px;
    }

    button:hover {
      background-color: #2e7031;
    }

    .custom-image {
      width: 200px;
      height: auto;
      display: block;
      margin: 20px auto;
      border-radius: 8px;
    }

    #map {
      height: 450px;
      margin: 20px 0;
    }

    #gps .leaflet-routing-container {
      background-color: #ffffff;
      border: 1px solid #c8e6c9;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      font-size: 14px;
      max-width: 1000px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
    }

    #gps .leaflet-routing-container h2 {
      font-size: 16px;
      color: #388e3c;
      margin-bottom: 10px;
    }

    #gps .leaflet-routing-container .leaflet-routing-alt {
      margin-top: 15px;
      border-top: 1px dashed #a5d6a7;
      padding-top: 10px;
    }

    .rota-details {
      margin: 20px auto;
      max-width: 1000px;
      border: 1px solid #c8e6c9;
      border-radius: 8px;
      background: #ffffff;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .rota-details summary {
      cursor: pointer;
      padding: 12px 16px;
      font-weight: bold;
      background-color: #dcedc8;
      color: #2e7031;
      border-bottom: 1px solid #c8e6c9;
      user-select: none;
    }

    .rota-details[open] summary {
      border-bottom: none;
    }

    .leaflet-routing-container {
      padding: 16px;
    }

    .details {  
      background: #dcedc8;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 4px;
    }

    iframe {
      width: 100%;
      max-width: 560px;
      height: 315px;
      margin: 20px auto;
      display: block;
    }

    footer {
      background-color: #333;
      color: #fff;
      text-align: center;
      padding: 10px;
      margin-top: 40px;
    }

    #n {
      font-size: 15px;
    }

    p {
      font-size: 20px;
    }

    select {
      background: #dcedc8;
      border-radius: 20px;
      font-size: 15px;
      padding: 5px;
      margin-top: 10px;
    }

    #h {
      margin-top: 0px;
      font-size: 22px;
      margin-top: 5px;
    }
  </style>
  </head>
<body>
  <header>
    <h1>EcoTech</h1>
    <h2 id="h">Localizador para Descarte Sustentável</h2>
    <h4 style="margin-top: 3px;">
      Encontre os locais mais próximos de você em Ponta Grossa para o descarte
      de eletrônicos
    </h4>
  </header>

  <nav>
    <button onclick="showSection('lixo')" class="active">
      Onde Descartar?
    </button>
    <button onclick="showSection('reutilizando')">
      Ideias de Reutilização
    </button>
    <button onclick="showSection('informacao')">
      Conteúdos Informativos
    </button>
  </nav>

  <section id="lixo" class="active">
    <h2>Auxiliando no descarte de lixo eletrônico</h2>
    <img
      src="https://i1.wp.com/blog.cicloorganico.com.br/wp-content/uploads/2020/08/captura-de-tela-2020-08-20-as-07-49-08.jpg?resize=700%2C640"
      alt="Lixo Eletrônico"
      class="custom-image"
    />

    <h3>Onde Descartar?</h3>
    <div class="form-group">
      <label for="cep">Digite seu CEP:</label>
      <input type="text" id="cep" placeholder="Ex: 84000-000" />
      <button onclick="buscarCEP()">Buscar Localização e Rotas</button>
    </div>

    <div id="map"></div>

    <div id="gps"></div>

    <h3>Locais de Coleta em Ponta Grossa</h3>
    <div id="locaisDetalhes"></div>
  </section>

  <section id="reutilizando">
    <h1>Ideias de Reutilização</h1>
    <br>
    <p>Escolha um eletrônico da lista e confira sugestões para reutilza-lo:   
      <select name="eletronico" id="eletronico" onchange="mostrarPlaylist()">
        <option value="escolha">Escolha uma opção</option>
        <option value="celular">Celular</option>
        <option value="monitor">Monitor</option>
        <option value="tablet">Tablet</option>
        <option value="mouse">Mouse</option>
        <option value="teclado">Teclado</option>
        <option value="impressora">Impressora</option>
      </select>
    </p>
    <div id="previa" style="margin-top: 50px; padding-bottom: 200px;">
      <h1 style="text-align: center; margin-top: 100px;">Reutilizar é dar nova vida ao que seria descartado.<br>
        Escolha um eletrônico acima e descubra ideias sustentáveis!</h1>
    </div>
  </section>

  <section id="informacao">
    <h1>Qual a importancia do descarte correto do e-lixo?</h1>
    <p>Segundo dados do <a href="https://g1.globo.com/jornal-nacional/noticia/2024/04/27/brasil-e-o-5o-pais-que-mais-produz-residuos-eletronicos-mas-descarte-correto-ainda-e-pequeno.ghtml">G1</a> e do <a href="https://www.brasildefato.com.br/2024/12/26/brasil-e-5-pais-que-mais-gera-lixo-eletronico-mas-so-3-e-descartado-corretamente-saiba-como-fazer/"> Brasil de Fato</a>
    . O Brasil é o 5° país que mais produz resíduos eletrônicos no mundo, produzindo 2,4 milhões de toneladas por ano. Porém apenas 3% desse lixo é descartado de forma correta, e ainda, dados indicam que 85% dos brasileiros possuem algum dispositivos eletrônico sem utilidade em casa e não sabem o que fazer com o tipo de resíduo.</p>
    <br>
    <p>Dispositivos eletrônicos são de extrema importância e fazem parte da nossa sociedade nos dias de hoje, porém, é importante nos atentarmos para o descarte desses dispositivos quando caem em desuso.</p>
    <br>
	  <p>Com o uso crescente desses aparelhos, também a quantidade de lixo eletrônico tem aumentado de forma desenfreada, mas pouco se fala da importância do descarte correto de resíduos do tipo.</p>
    <br>
    <p>Equipamentos elétricos e eletrônicos possuem diversos componentes tóxicos que quando descartados incorretamente em lixos comuns ou até mesmo ao ar livre, podem gerar consequências ao ecossistema, ao meio ambiente, à fauna e inclusive à população.</p>
    <br>
	  <p>Isso se dá pois, os componentes citados anteriormente podem contaminar o solo e o lençol freático, prejudicando a fauna e os rios que podem ser fonte de água para a população, tornando alimentos e água contaminados impróprios para o consumo.</p>
    <br>
	  <p>E, se consumidos ou inalados de forma involuntária, esses metais pesados podem causar danos neurológicos, renais, ósseos, circulatórios, hipertensão, anemia, câncer e paralisia nos seres humanos. Por isso, é importante o descarte adequado desses materiais.</p>
    <br><br><br>
    <h1>O que é lixo eletrônico?</h1>
    <p>Lixo eletrônico é todo equipamento elétrico ou eletrônico que atingiu ofim de sua vida útil. São classificados nas seguintes linhas:</p>
    <br>
    <ul>
      <li><strong>Linha Branca:</strong> São eletrodomésticos de grande porte como geladeiras, freezers, fogões, ar condicionado, microondas, máquinas de lavar, secadoras, etc.</li><br>
      <li><strong>Linha Marrom:</strong> Essa linha inclui equipamentos de aúdio e vídeo, por exemplo TVs e monitores de tubo, plasma, LCD e LED, equipamentos de DVD/VHS, aparelhos de som, filmadoras, etc.</li><br>
      <li><strong>Linha Verde:</strong> Engloba cabos, servidores, pilhas, smartphones, notebooks, desktops, tablets, mouses, teclados, carregadores, fones, etc.</li><br>
      <li><strong>Linha Azul:</strong> Refere-se a eletrodomésticos portáteis em geral como liquidificadores, batedeiras, ferro elétrico, secadores de cabelo, furadeiras, cafeteiras, etc.</li><br>
    </ul>
    <br><br><br>
    <h1>O que acontece com o resíduo eletrônico após o descarte?</h1>
    <p>Grande parte dos eletrônicos passa por um processo de reciclagem que consiste em recuperar materiais como metais e plásticos para transformá-los em matéria-prima para novos produtos. Esse ciclo reduz o impacto ambiental e à saúde, além disso, contribui para a economia circular.</p>
    <br>
    <p>Componentes contaminados ou potencialmente perigosos são separados cuidadosamente e enviados para aterros sanitários controlados ou para coprocessamento, esses métodos são projetados para evitar a contaminação do solo e da água.</p>
  </section>

  <footer>
    <p id="n">IFPR - Campus Curitiba - Centro de Referência Ponta Grossa</p>
    <p id="n">Todos os direitos protegidos</p>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
  <script>
    const locais = [
      {
        nome: "R&A Lidera",
        lat: -25.0771,
        lng: -50.1412,
        endereco: "R. Rio Paraná, 112 - Chapada",
        horario: "Não atendeu",
        tel: "+55 42 99929-5248",
      },
      {
        nome: "Recisul",
        lat: -25.1067,
        lng: -50.1567,
        endereco: "R. Tobias Moscoso, 743 - Ronda",
        horario: "Horário não informado",
        tel: "+55 42 3223-3359",
      },
      {
        nome: "Sustentar Resíduos",
        lat: -25.1234,
        lng: -50.1345,
        endereco: "R. Avelino Rosa Neto, 292 - Boa Vista",
        horario: "Horário não informado",
        tel: "+55 42 93300-1181",
      },
      {
        nome: "Usina de Reciclagem",
        lat: -25.0901,
        lng: -50.1303,
        endereco: "Cará-Cará",
        horario: "Horário não informado",
        tel: "+55 42 3025-7575",
      },
      {
        nome: "Zero Resíduos",
        lat: -25.0987,
        lng: -50.1609,
        endereco: "R. Arquiteto Nicolau Ferigotti, 300 - Uvaranas",
        horario: "Talvez seja paga",
        tel: "+55 42 3220-0300",
      },
      {
        nome: "Vivo - Loja",
        lat: -25.0834,
        lng: -50.1523,
        endereco: "Av. Dr. Vicente Machado, 505",
        horario: "Seg‑Sex: 09h‑19h",
        tel: "(42) 99119-9292",
      },
    ];

    let map = L.map("map").setView([-25.0946, -50.1637], 13);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

    const iconVerde = L.icon({
      iconUrl: "https://maps.google.com/mapfiles/ms/icons/green-dot.png",
      iconSize: [32, 32],
      iconAnchor: [16, 32],
    });
    const iconAzul = L.icon({
      iconUrl: "https://maps.google.com/mapfiles/ms/icons/blue-dot.png",
      iconSize: [32, 32],
      iconAnchor: [16, 32],
    });

    // Marcadores dos locais (verde)
    locais.forEach((loc) => {
      L.marker([loc.lat, loc.lng], { icon: iconVerde })
        .addTo(map)
        .bindPopup(
          `<strong>${loc.nome}</strong><br>${loc.endereco}<br>${loc.tel}<br>${loc.horario}`
        );
    });

    // Mostra detalhes embaixo
    const detalhes = document.getElementById("locaisDetalhes");
    locais.forEach((l) => {
      const div = document.createElement("div");
      div.className = "details";
      div.innerHTML = `<strong>${l.nome}</strong><br>Endereço: ${l.endereco}<br>Telefone: ${l.tel}<br>Horário: ${l.horario}`;
      detalhes.appendChild(div);
    });
    
    // Armazena rotas para remover depois
    let rotas = [];
    let marcadorUser = null;

    // Função para calcular distância em km entre duas coordenadas usando Haversine
    function calcularDistancia(lat1, lon1, lat2, lon2) {
      function toRad(x) {
        return (x * Math.PI) / 180;
      }

      var R = 6371; // km
      var dLat = toRad(lat2 - lat1);
      var dLon = toRad(lon2 - lon1);
      var a =
        Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(toRad(lat1)) *
          Math.cos(toRad(lat2)) *
          Math.sin(dLon / 2) *
          Math.sin(dLon / 2);
      var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      var d = R * c;
      return d;
    }

    // Paleta de cores para rotas
    const coresRotas = [
      "#1f77b4",
      "#ff7f0e",
      "#2ca02c",
      "#d62728",
      "#9467bd",
      "#8c564b",
      "#e377c2",
    ];

    async function buscarCEP() {
      const cep = document.getElementById("cep").value.replace(/\D/g, "");
      if (cep.length !== 8) return alert("CEP inválido.");

      try {
        // Busca dados do CEP
        const resCep = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
        const dataCep = await resCep.json();
        if (dataCep.erro) return alert("CEP não encontrado.");

        const endereco = `${dataCep.logradouro}, ${dataCep.localidade}, ${dataCep.uf}, Brasil`;

        // Geocodifica endereço para latlng
        const resGeo = await fetch(
          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(
            endereco
          )}`
        );
        const dataGeo = await resGeo.json();
        if (!dataGeo.length) return alert("Endereço não encontrado.");

        const userLatLng = L.latLng(dataGeo[0].lat, dataGeo[0].lon);

        // Remove rotas anteriores
        rotas.forEach((r) => map.removeControl(r));
        rotas = [];

        // Remove marcador antigo do usuário se existir
        if (marcadorUser) {
          map.removeLayer(marcadorUser);
          marcadorUser = null;
        }

        // Adiciona marcador azul para usuário
        marcadorUser = L.marker(userLatLng, { icon: iconAzul })
          .addTo(map)
          .bindPopup("Você está aqui")
          .openPopup();

        // Centraliza no usuário
        map.setView(userLatLng, 13);

        // Filtra locais até 6km
        const locaisProximos = locais.filter((loc) => {
          const dist = calcularDistancia(
            userLatLng.lat,
            userLatLng.lng,
            loc.lat,
            loc.lng
          );
          return dist <= 6;
        });

        if (!locaisProximos.length)
          return alert("Nenhum local de descarte encontrado até 6km.");

        // Para cada local próximo, cria uma rota com cor diferente
        locaisProximos.forEach((loc, index) => {
          const cor = coresRotas[index % coresRotas.length];

          const rota = L.Routing.control({
            waypoints: [userLatLng, L.latLng(loc.lat, loc.lng)],
            lineOptions: {
              styles: [{ color: cor, opacity: 0.8, weight: 5 }],
            },
            language: "pt-BR",
            addWaypoints: false,
            draggableWaypoints: false,
            fitSelectedRoutes: false,
            createMarker: () => null,
          }).addTo(map);

          rotas.push(rota);

          rota.on('routeselected', () => {
          const container = document.querySelector('.leaflet-routing-container');
          const destino = document.getElementById('gps');
          if (container && destino) {
            const details = document.createElement('details');
            details.className = 'rota-details';

            const summary = document.createElement('summary');
            summary.textContent = `Ver instruções da rota para ${loc.nome}`;

            details.appendChild(summary);
            details.appendChild(container);
            destino.appendChild(details);
          }
        });
        });
      } catch (error) {
        alert("Erro ao buscar localização: " + error.message);
      }
    }

    function showSection(id) {
      document.querySelectorAll("section").forEach((sec) => {
        sec.classList.remove("active");
      });
      document.getElementById(id).classList.add("active");

      document.querySelectorAll("nav button").forEach((btn) => {
        btn.classList.remove("active");
      });
      event.target.classList.add("active");
    }

    function mostrarPlaylist() {
      const select = document.getElementById("eletronico");
      const preview = document.getElementById("previa");

      const playlists = {
        celular: "https://www.youtube.com/embed/videoseries?list=PLVm-74uyST2htlgiLQe36UQA9g8SokKvn",
        monitor: "https://www.youtube.com/embed/videoseries?list=PLVm-74uyST2hvJI5fG-N9hn3UexqBXxKR",
        tablet: "https://www.youtube.com/embed/videoseries?list=PLVm-74uyST2jq1XZftHTMAd2SvCSGO8xV",
        mouse: "https://www.youtube.com/embed/videoseries?list=PLVm-74uyST2gYKKMmkZxaODx2u24F3MCG",
        teclado: "https://www.youtube.com/embed/videoseries?list=PLVm-74uyST2jD89Yb8TujJG0ZtaPOpK2M",
        impressora: "https://www.youtube.com/embed/videoseries?list=PLVm-74uyST2i6TTFa9wHvFYUAb6lZAQtn",
      };

      const escolhido = select.value;

      if (playlists[escolhido]) {
        preview.innerHTML = `
          <iframe 
            src="${playlists[escolhido]}" 
            width="100%" 
            height="315" 
            allowfullscreen>
          </iframe>
        `;
      } else {
        preview.innerHTML = `
          <h1
            style="text-align: center; margin-top: 100px;">
            Reutilizar é dar nova vida ao que seria descartado.<br>
            Escolha um eletrônico acima e descubra ideias sustentáveis!
          </h1>
        `;
      }
    }
  </script>
</body>
</html>
